<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Sinh Viên</title>
    
    <style>
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --ink: #1a1a1a;
            --muted: #6b6b6b;
            --accent: #2d5a3d;
            --accent-light: #4a8c62;
            --cream: #f7f4ef;
            --rule: #d8d0c4;
            --surface: #ffffff;
            --error: #c0392b;
        }

        body {
            background: var(--cream);
            color: var(--ink);
            font-family: 'System UI';
            min-height: 100vh;
            padding: 3rem 2rem;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            border: 1px solid var(--rule);
            bottom: -200px;
            right: -150px;
            pointer-events: none;
            z-index: 0;
        }

        .page {
            position: relative;
            z-index: 1;
            max-width: 560px;
            margin: 0 auto;
            animation: fadeUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) both;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.72rem;
            font-weight: 500;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--muted);
            text-decoration: none;
            margin-bottom: 2.5rem;
            transition: color 0.2s;
        }

        .back-link::before { content: '←'; transition: transform 0.2s; }
        .back-link:hover { color: var(--accent); }
        .back-link:hover::before { transform: translateX(-3px); }

        .eyebrow {
            font-size: 0.7rem;
            font-weight: 500;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .eyebrow::before {
            content: '';
            display: block;
            height: 1px;
            width: 32px;
            background: var(--accent);
            opacity: 0.5;
        }

        h1 {
            font-family: 'System UI';
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 300;
            line-height: 1.2;
            color: var(--ink);
            margin-bottom: 2rem;
        }

        h1 em { font-style: italic; color: var(--accent); }

        /* ── Form card ── */
        .card {
            background: var(--surface);
            border: 1px solid var(--rule);
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .field-group {
            margin-bottom: 1.5rem;
        }

        .field-group:last-child { margin-bottom: 0; }

        label {
            display: block;
            font-size: 0.68rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 0.5rem;
        }

        input[type="text"],
        input[type="number"],
        input[type="email"] {
            width: 100%;
            padding: 0.7rem 1rem;
            border: 1px solid var(--rule);
            background: var(--cream);
            font-family: 'System UI';
            font-size: 0.9rem;
            color: var(--ink);
            outline: none;
            transition: border-color 0.2s, background 0.2s;
        }

        input:focus {
            border-color: var(--accent);
            background: var(--surface);
        }

        input[readonly] {
            color: var(--muted);
            cursor: not-allowed;
            background: #f0ebe3;
        }

        .field-hint {
            font-size: 0.72rem;
            color: var(--muted);
            margin-top: 0.35rem;
        }

        .divider {
            width: 100%;
            height: 1px;
            background: var(--rule);
            margin: 1.5rem 0;
        }

        /* ── Actions ── */
        .actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .btn-save {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.7rem 1.8rem;
            background: var(--accent);
            color: var(--cream);
            border: none;
            font-family: 'System-UI';
            font-size: 0.78rem;
            font-weight: 500;
          
            border-radius:18px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            cursor: pointer;
            transition: background 0.2s, transform 0.2s;
        }

        .btn-save:hover {
            background: var(--accent-light);
            transform: translateY(-1px);
        }

        .btn-cancel {
            font-size: 0.72rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--muted);
            text-decoration: none;
            transition: color 0.2s;
        }

        .btn-cancel:hover { color: var(--ink); }

        /* ── Footer ── */
        .footer-rule {
            margin-top: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--rule);
            font-size: 0.68rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
        }

        .footer-rule::before, .footer-rule::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--rule);
        }

        .deco-line {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            opacity: 0.3;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="page">

    <a class="back-link" href="/students">Quay lại danh sách</a>

    <!--
        Nếu student.id == null → đang TẠO MỚI  → action POST /students
        Nếu student.id != null → đang CHỈNH SỬA → action POST /students/edit/{id}
    -->
    <p class="eyebrow" th:text="${student.id == null} ? 'Thêm mới' : 'Chỉnh sửa'">Thêm mới</p>
    <h1 th:text="${student.id == null} ? 'Thêm sinh viên' : 'Chỉnh sửa Sinh Viên'">
        Thêm Sinh Viên
    </h1>

    <!-- TẠO MỚI -->
    <form th:if="${student.id == null}"
          th:action="@{/students}"
          th:object="${student}"
          method="post">

        <div class="card">
            <div class="field-group">
                <label for="id">Mã sinh viên</label>
                <input type="text" th:field="*{id}" id="id" placeholder="VD: SV001" required />
            </div>

            <div class="divider"></div>

            <div class="field-group">
                <label for="name">Họ và tên</label>
                <input type="text" th:field="*{name}" id="name" placeholder="Nguyễn Văn A" />
            </div>

            <div class="field-group">
                <label for="email">Email</label>
                <input type="text" th:field="*{email}" id="email" placeholder="example@email.com" />
            </div>

            <div class="field-group">
                <label for="age">Tuổi</label>
                <input type="number" th:field="*{age}" id="age" placeholder="20" min="1" max="100" />
            </div>
        </div>

        <div class="actions">
            <button class="btn-save" type="submit">Lưu sinh viên</button>
            <a class="btn-cancel" href="/students">Hủy</a>
        </div>
    </form>

    <!-- CHỈNH SỬA -->
    <form th:if="${student.id != null}"
          th:action="@{/students/edit/{id}(id=${student.id})}"
          th:object="${student}"
          method="post">

        <input type="hidden" th:field="*{id}" />

        <div class="card">
            <div class="field-group">
                <label>Mã sinh viên</label>
                <input type="text" th:value="${student.id}" readonly />
                <p class="field-hint">Mã sinh viên không thể thay đổi sau khi tạo.</p>
            </div>

            <div class="divider"></div>

            <div class="field-group">
                <label for="name-edit">Họ và tên</label>
                <input type="text" th:field="*{name}" id="name-edit" />
            </div>

            <div class="field-group">
                <label for="email-edit">Email</label>
                <input type="text" th:field="*{email}" id="email-edit" />
            </div>

            <div class="field-group">
                <label for="age-edit">Tuổi</label>
                <input type="number" th:field="*{age}" id="age-edit" min="1" max="100" />
            </div>
        </div>

        <div class="actions">
            <button class="btn-save" type="submit">Lưu thay đổi</button>
            <a class="btn-cancel" th:href="@{/students/{id}(id=${student.id})}">Hủy</a>
        </div>
    </form>

    <div class="footer-rule">Student Management System</div>
</div>

<div class="deco-line"></div>

</body>
</html>